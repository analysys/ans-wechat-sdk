"use strict";var e={base:{outer:["appid","xwho","xwhat","xwhen","xcontext"],xcontext:["$lib","$lib_version","$platform","$debug","$is_login"]},$startup:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated","$is_first_time","$referrer","$scene"]},$track:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated"]},$pageview:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated","$referrer","$scene","$startup_time","$url","$share_id","$share_path","$share_level"]},$alias:{xcontext:["$original_id"]},$getPresetProperties:{xcontext:["$time_zone","$language","$screen_width","$screen_height","$network","$first_visit_time","$brand","$model","$os","$session_id"]}},y={base:{appid:"",$debug:0,$lib_version:"4.3.0",$lib:"WeChat",uploadURL:"",auto:!0,autoProfile:!0,encryptType:0,autoShare:!1,$share_level:"",$share_path:"",$share_id:"",appProperty:null,allowTimeCheck:!1,maxDiffTimeInterval:30,logflag:!1},status:{code:200,FnName:"",key:"",value:"",errorCode:"",successCode:""},system:{system:null,netWork:null,scene:null},isStartUp:!1,FnCatch:[],FnSuperCatch:[],keywords:e.base.xcontext,baseJson:e.base.outer,sendNum:1800},a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}(),r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},v=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)},s=function(r){return new Promise(function(t,a){try{var e=wx.getStorageSync(r);e&&t(e)}catch(e){wx.getStorage({key:r,success:function(e){t(e.data)},fail:function(e){a(e)}})}}).catch(function(e){})},o=function(n,e){return new Promise(function(t,a){var r=e;try{wx.setStorageSync(n,r),t(200)}catch(e){wx.setStorage({key:n,data:r,success:function(){t(200)},fail:function(){a(400)}})}}).catch(function(e){})},u=function(){function e(){var t=this;a(this,e),this.local={},s("FZ_STROAGE").then(function(e){e.constructor===String&&(e=JSON.parse(e)),t.local=g.objMerge(e,t.local)||{},o("FZ_STROAGE",t.local).then(function(){},function(e){}).catch(function(e){})},function(){t.local={}}).catch(function(e){}),this.Session={}}return t(e,[{key:"setData",value:function(e,t){this.Session[e]=t}},{key:"getData",value:function(e){return"undefind"===this.Session[e]?"":this.Session[e]}},{key:"removeData",value:function(e){"undefind"!==this.Session[e]&&delete this.Session[e]}},{key:"clearData",value:function(){this.Session={}}},{key:"setLocal",value:function(e,t){this.local[e]=t;var a=this.local;o("FZ_STROAGE",a).then(function(){},function(e){}).catch(function(e){})}},{key:"getLocal",value:function(e){return this.local[e]}},{key:"removeLocal",value:function(e){if("undefind"!==this.local[e]){delete this.local[e];var t=this.local;o("FZ_STROAGE",t).then(function(){},function(){}).catch(function(e){})}}}]),e}(),f=new u,i=function(){function e(){a(this,e)}return t(e,[{key:"paramType",value:function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","")}},{key:"delEmpty",value:function(e){var a=this,r=this.deepClone(e);return"Object"!==this.paramType(r)?{}:(Object.keys(r).forEach(function(e){var t=r[e];"Object"===a.paramType(t)&&(r[e]=a.delEmpty(r[e]),0===Object.keys(r[e]).length&&delete r[e]),""===t&&delete r[e]}),r)}},{key:"deepClone",value:function(e){var t=Object.getPrototypeOf(e);return Object.assign({},Object.create(t),e)}},{key:"mergeMsg",value:function(e,t){Object.assign(t,e)}},{key:"checkObj",value:function(e,t){var a={};if(1!==arguments.length||e.constructor!==Array)return 1===arguments.length&&e.constructor===String?a[e]=t||"":1<arguments.length&&e.constructor!==Object?a[e]=t:a=e,a;for(var r=0;r<e.length;r++)a[e[r]]="";return a}},{key:"isFristDay",value:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var r=e.getDate(),n=t+""+a+(r=r<10?"0"+r:r),s=f.getLocal("FRISTDAY");return(!s||n===s)&&(s||f.setLocal("FRISTDAY",n),!0)}},{key:"isFristTime",value:function(){var e=!1!==f.getLocal("FRISTIME");return e&&f.setLocal("FRISTIME",!1),e}},{key:"isEmptyObject",value:function(e){return!(0<Object.keys(e).length)}},{key:"setFristDay",value:function(){var e=this.format(new Date,"yyyyMMdd");y.base.allowTimeCheck&&y.base.logflag&&(e=this.format(new Date(+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)),"yyyyMMdd")),f.setLocal("FRISTDAY",e)}},{key:"setFristTime",value:function(){f.setLocal("FRISTIME",!0)}},{key:"delFristDay",value:function(){f.removeLocal("FRISTDAY")}},{key:"delFristTime",value:function(){f.removeLocal("FRISTIME")}},{key:"checkURL",value:function(e){var t=e;return 1==new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(t)}},{key:"firstVisitTime",value:function(){var e=!1!==f.getLocal("FIRSTVISITTIME");return e&&f.setLocal("FIRSTVISITTIME",!1),e}},{key:"toDeepObj",value:function(e,t){var a={};if("String"===this.paramType(e))return a=this.keyValueToObje(e,t);if("Array"===this.paramType(e))return a=this.ArrayToObj(e);if("Object"===this.paramType(e))for(var r in e)a[r]=this.toDeepObj(e[r]);return a}},{key:"ArrayToObj",value:function(e){for(var t={},a=0;a<e.length;a++)t[e[a]]="";return t}},{key:"keyValueToObje",value:function(e,t){var a={};return a[e]=t||"",a}},{key:"toObj",value:function(e,t){var a={};return"String"===this.paramType(e)?a=this.keyValueToObje(e,t):"Array"===this.paramType(e)?a=this.ArrayToObj(e):"Object"===this.paramType(e)?e:a}},{key:"objMerge",value:function(e,t){if("Object"!==this.paramType(e)||"Object"!==this.paramType(t))return e;var a={};for(var r in e)a[r]=e[r];for(var r in t)a[r]&&"Object"===this.paramType(a[r])&&"Object"===this.paramType(t[r])?a[r]=this.objMerge(a[r],t[r]):"Array"===this.paramType(a[r])&&"Array"===this.paramType(t[r])?a[r]=this.arrayMergeUnique(a[r],t[r]):a[r]=t[r];return a}},{key:"arrayUnique",value:function(e){for(var t=[],a={},r=0;r<e.length;r++)a[e[r]]||(a[e[r]]=!0,t.push(e[r]));return t}},{key:"arrayMerge",value:function(e,t){return e.push.apply(e,t),e}},{key:"arrayMergeUnique",value:function(e,t){return e.push.apply(e,t),this.arrayUnique(e)}},{key:"format",value:function(e,t){var a=e.getTimezoneOffset(),r={"M+":(e=new Date(e.getTime()+60*a*1e3+288e5)).getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,3==RegExp.$1.length?(""+r[n]).length<3?("00"+r[n]).substr(("00"+r[n]).length-3,("00"+r[n]).length):r[n]:("00"+r[n]).substr((""+r[n]).length)));return t}},{key:"objHasKay",value:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{key:"clientTimeZone",value:function(){var e=(new Date).getTimezoneOffset(),t=parseInt(e/60),a=e%60,r="-";return(t<=0||a<0)&&(r="+",t=-t,a<0&&(a=-a)),1==(t+="").length&&(t="0"+t),1==(a+="").length&&(a="0"+a),r+t+":"+a}},{key:"objInArray",value:function(e){var t=[];return t.push(e),t}}]),e}(),g=new i,c={common:"{FN}:Property key invalid, nonsupport value: $lib/$lib_version/$platform/$first_visit_time/$debug/$is_login \ncurrent KEY:{KEY}",60001:"{FN}:Property key invalid, support type: String \ncurrent key:{KEY}\ncurrent keyType:{KEYTYPE}",60002:"{FN}:Property value invalid of key[{KEY}], support type: Number \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60003:"{FN}:Property value invalid of key[{KEY}], support type: Boolean \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60004:"{FN}:Property value invalid of key[{KEY}], support type: Array \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60005:"{FN}:The length of the property[{KEY}] value (string[{VALUE}]) needs to be 1-255 !",60006:"Please set appkey first.",60007:"Please set uploadURL first.",60008:"Send message failed.",60009:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-125 !",600010:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-99 !",600011:"{FN}:[{KEY}] does not conform to naming rules!",600012:"{FN}:Property key invalid, nonsupport value: $lib/$lib_version/$platform/$first_visit_time/$debug/$is_login \ncurrent KEY:{KEY}",600013:"{FN}:Property value invalid of key[{KEY}], support type: Array with String as its internal element \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600016:"{FN}:Property value invalid of key[{KEY}], support type: Object \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600017:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-255 !",600018:"{FN}:Property value invalid of key[{KEY}] invalid, support type: String \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600019:"{FN}:The length of the property[{KEY}] value (string[{VALUE}]) needs to be 1-255 !",600020:"DebugMode only can be 0,1,2",600021:"{FN}:Property value invalid of key[{KEY}], support type: Object, Object.keys length needs to be 1-499 \ncurrent length:{VALUE}\n"},l={common:"",20001:"Send message success",20002:"{FN}: set success ({VALUE})",20003:"{FN}:({VALUE}) delete success",20004:"{FN}:clear success",20005:"{FN}:reset success",20006:"set appkey success. current appkey : {VALUE}",20007:"Init Analysys WeChat sdk success, version : {VALUE}",20008:"set uploadURL success. current uploadURL : {VALUE}",20009:"{FN}:[{KEY}] : get failed",20010:"{FN}:[{KEY}] : get success. ({VALUE})",20011:"{FN}:({VALUE}) delete failed",20012:"Send Message to Server: {KEY} \ndata:{VALUE}",20013:"收到服务器的时间: {VALUE} \n本地时间: {KEY} \n时间相差:  {FN} \n数据将会进行时间校准"};function p(e){if(1===y.base.$debug||2===y.base.$debug){var t=y.status,a=t.successCode,r=t.FnName,n=t.key,s=t.value,o=(l[a]||l.common).replace(/{FN}/,r).replace(/{KEY}/g,n).replace(/{VALUE}/g,s);if(e&&(o=e),!o)return;if("Object"===g.paramType(console)&&console.log)try{return console.log.apply(console,o)}catch(e){console.log(o)}}}function m(){var e=y.status,t=e.errorCode,a=e.FnName,r=e.key,n=JSON.stringify(e.value),s=g.paramType(e.value),o=g.paramType(r),u=(c[t]||c.common).replace(/{FN}/g,a).replace(/{KEY}/g,JSON.stringify(r)).replace(/{VALUE}/g,n).replace(/{VALUETYPE}/g,s).replace(/{KEYTYPE}/g,o);1!==y.base.$debug&&2!==y.base.$debug||console.warn(u)}var h=function(){function e(){a(this,e)}return t(e,[{key:"isString",value:function(e){return y.status.errorCode="60001","String"===g.paramType(e)}},{key:"isNumber",value:function(e){return y.status.errorCode="60002","Number"===g.paramType(e)}},{key:"isBoolean",value:function(e){return y.status.errorCode="60003","Boolean"===g.paramType(e)}},{key:"isObject",value:function(e){return"Object"===g.paramType(e)}},{key:"lengthRule",value:function(e,t,a){this.isNumber(a)||(a=1/0);var r=!0;return this.isNumber(t)&&e.length&&e.length>t&&e.length<a+1||(r=!(y.status.errorCode="60005")),r}},{key:"nimLength",value:function(e){return this.lengthRule(e,0)}},{key:"length99",value:function(e){var t=this.lengthRule(e,0,99);return t||(y.status.errorCode="600010"),t}},{key:"length125",value:function(e){var t=this.lengthRule(e,0,125);return t||(y.status.errorCode="60009"),t}},{key:"length255",value:function(e){if(!(e||this.isString(e)||this.isNumber(e)||this.isBoolean(e)))return!(y.status.errorCode="60005");"String"!==g.paramType(e)&&(e=e.toString());var t=this.lengthRule(e,0,255);return t||(y.status.errorCode="600019"),t}},{key:"keyLength255",value:function(e){var t=this.length255(e);return t||(y.status.errorCode="600017"),t}},{key:"isURL",value:function(e){var t=e;return 1==new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(t)||!(y.status.errorCode="60006")}},{key:"isDebug",value:function(e){return!(!this.isNumber(e)||0!==e&&1!==e&&2!==e)}},{key:"notObject",value:function(e){return!this.isObject(e)}},{key:"notSpecialCharacters",value:function(e){return!(new RegExp("[\\u4E00-\\u9FA5]|[\\uFE30-\\uFFA0]","gi").test(e)||!/^[$a-zA-Z][a-zA-Z0-9_$]{0,}$/.test(e))||!(y.status.errorCode="600011")}},{key:"isArrayString",value:function(e){if("Array"===g.paramType(e))for(var t=0;t<e.length;t++){if("String"!==g.paramType(e[t]))return!(y.status.errorCode="600013");if(!this.length255(e[t]))return 500<e[t].length&&(e[t]=g.stringSlice(e[t],499)+"$"),y.status.value=e[t],!1}return!0}},{key:"keywords",value:function(e){return!(-1<y.keywords.indexOf(e))}}]),e}(),d=new h;function S(e,t){var a=e;function u(e,t){return e<<t|e>>>32-t}function i(e,t){var a,r,n,s,o;return n=2147483648&e,s=2147483648&t,o=(1073741823&e)+(1073741823&t),(a=1073741824&e)&(r=1073741824&t)?2147483648^o^n^s:a|r?1073741824&o?3221225472^o^n^s:1073741824^o^n^s:o^n^s}function r(e,t,a,r,n,s,o){return e=i(e,i(i(function(e,t,a){return e&t|~e&a}(t,a,r),n),o)),i(u(e,s),t)}function n(e,t,a,r,n,s,o){return e=i(e,i(i(function(e,t,a){return e&a|t&~a}(t,a,r),n),o)),i(u(e,s),t)}function s(e,t,a,r,n,s,o){return e=i(e,i(i(function(e,t,a){return e^t^a}(t,a,r),n),o)),i(u(e,s),t)}function o(e,t,a,r,n,s,o){return e=i(e,i(i(function(e,t,a){return t^(e|~a)}(t,a,r),n),o)),i(u(e,s),t)}function c(e){var t="",a="",r=void 0;for(r=0;r<=3;r++)t+=(a="0"+(e>>>8*r&255).toString(16)).substr(a.length-2,2);return t}var l=Array(),p=void 0,y=void 0,v=void 0,f=void 0,g=void 0,m=void 0,h=void 0,d=void 0,S=void 0;for(l=function(e){for(var t=void 0,a=e.length,r=a+8,n=16*(1+(r-r%64)/64),s=Array(n-1),o=0,u=0;u<a;)o=u%4*8,s[t=(u-u%4)/4]=s[t]|e.charCodeAt(u)<<o,u++;return o=u%4*8,s[t=(u-u%4)/4]=s[t]|128<<o,s[n-2]=a<<3,s[n-1]=a>>>29,s}(a),m=1732584193,h=4023233417,d=2562383102,S=271733878,p=0;p<l.length;p+=16)m=r(y=m,v=h,f=d,g=S,l[p+0],7,3614090360),S=r(S,m,h,d,l[p+1],12,3905402710),d=r(d,S,m,h,l[p+2],17,606105819),h=r(h,d,S,m,l[p+3],22,3250441966),m=r(m,h,d,S,l[p+4],7,4118548399),S=r(S,m,h,d,l[p+5],12,1200080426),d=r(d,S,m,h,l[p+6],17,2821735955),h=r(h,d,S,m,l[p+7],22,4249261313),m=r(m,h,d,S,l[p+8],7,1770035416),S=r(S,m,h,d,l[p+9],12,2336552879),d=r(d,S,m,h,l[p+10],17,4294925233),h=r(h,d,S,m,l[p+11],22,2304563134),m=r(m,h,d,S,l[p+12],7,1804603682),S=r(S,m,h,d,l[p+13],12,4254626195),d=r(d,S,m,h,l[p+14],17,2792965006),m=n(m,h=r(h,d,S,m,l[p+15],22,1236535329),d,S,l[p+1],5,4129170786),S=n(S,m,h,d,l[p+6],9,3225465664),d=n(d,S,m,h,l[p+11],14,643717713),h=n(h,d,S,m,l[p+0],20,3921069994),m=n(m,h,d,S,l[p+5],5,3593408605),S=n(S,m,h,d,l[p+10],9,38016083),d=n(d,S,m,h,l[p+15],14,3634488961),h=n(h,d,S,m,l[p+4],20,3889429448),m=n(m,h,d,S,l[p+9],5,568446438),S=n(S,m,h,d,l[p+14],9,3275163606),d=n(d,S,m,h,l[p+3],14,4107603335),h=n(h,d,S,m,l[p+8],20,1163531501),m=n(m,h,d,S,l[p+13],5,2850285829),S=n(S,m,h,d,l[p+2],9,4243563512),d=n(d,S,m,h,l[p+7],14,1735328473),m=s(m,h=n(h,d,S,m,l[p+12],20,2368359562),d,S,l[p+5],4,4294588738),S=s(S,m,h,d,l[p+8],11,2272392833),d=s(d,S,m,h,l[p+11],16,1839030562),h=s(h,d,S,m,l[p+14],23,4259657740),m=s(m,h,d,S,l[p+1],4,2763975236),S=s(S,m,h,d,l[p+4],11,1272893353),d=s(d,S,m,h,l[p+7],16,4139469664),h=s(h,d,S,m,l[p+10],23,3200236656),m=s(m,h,d,S,l[p+13],4,681279174),S=s(S,m,h,d,l[p+0],11,3936430074),d=s(d,S,m,h,l[p+3],16,3572445317),h=s(h,d,S,m,l[p+6],23,76029189),m=s(m,h,d,S,l[p+9],4,3654602809),S=s(S,m,h,d,l[p+12],11,3873151461),d=s(d,S,m,h,l[p+15],16,530742520),m=o(m,h=s(h,d,S,m,l[p+2],23,3299628645),d,S,l[p+0],6,4096336452),S=o(S,m,h,d,l[p+7],10,1126891415),d=o(d,S,m,h,l[p+14],15,2878612391),h=o(h,d,S,m,l[p+5],21,4237533241),m=o(m,h,d,S,l[p+12],6,1700485571),S=o(S,m,h,d,l[p+3],10,2399980690),d=o(d,S,m,h,l[p+10],15,4293915773),h=o(h,d,S,m,l[p+1],21,2240044497),m=o(m,h,d,S,l[p+8],6,1873313359),S=o(S,m,h,d,l[p+15],10,4264355552),d=o(d,S,m,h,l[p+6],15,2734768916),h=o(h,d,S,m,l[p+13],21,1309151649),m=o(m,h,d,S,l[p+4],6,4149444226),S=o(S,m,h,d,l[p+11],10,3174756917),d=o(d,S,m,h,l[p+2],15,718787259),h=o(h,d,S,m,l[p+9],21,3951481745),m=i(m,y),h=i(h,v),d=i(d,f),S=i(S,g);return 32==t?c(m)+c(h)+c(d)+c(S):c(h)+c(d)}var T=function(){function e(){a(this,e),this.sessionId=f.getLocal("SEESIONID")||this.setId(),this.sessionDate=f.getLocal("SEESIONDATE")||0}return t(e,[{key:"setId",value:function(){var e=+new Date;return this.sessionId=S("WeChat"+e.toString()+Math.random(0,1e7)),this.sessionDate=e,f.setLocal("SEESIONID",this.sessionId),f.setLocal("SEESIONDATE",this.sessionDate),this.sessionId}},{key:"getId",value:function(){var e=new Date,t=e.getTime(),a=e.getTimezoneOffset(),r=new Date(t+60*a*1e3+288e5).getDate();this.sessionDate=f.getLocal("SEESIONDATE")||0;var n=0===this.sessionDate?0:new Date(this.sessionDate+60*a*1e3+288e5).getDate();return(""===this.sessionId||0===this.sessionDate||18e5<Number(t)-Number(this.sessionDate)||n!==r)&&this.setId(),this.sessionDate=t,f.setLocal("SEESIONDATE",t),this.sessionId=f.getLocal("SEESIONID")||this.setId(),this.sessionId}}]),e}(),A=new T,b=function(){function e(){a(this,e)}return t(e,[{key:"getId",value:function(){var e=f.getLocal("ARK_LOGINID")||f.getLocal("ARK_TRACKID")||f.getLocal("ARK_ID");return e||(e=this.setId(),f.setLocal("ARK_ID",e)),e}},{key:"setId",value:function(){var e=new String((new Date).getTime())+new String(1e4*Math.random());return"WX"+S(new String(e),32)+S(new String(e),32).slice(0,4)}},{key:"jsId",value:function(){var e=f.getLocal("ARK_ID");return e=e||this.setId()}},{key:"removeARKId",value:function(){f.removeLocal("ARK_ID")}},{key:"setLoginId",value:function(e){e&&f.setLocal("ARK_LOGINID",e)}},{key:"setLoginOId",value:function(e){e&&f.setLocal("ARK_LOGINOID",e)}},{key:"getLoginOId",value:function(){return f.getLocal("ARK_LOGINOID")}},{key:"getLoginId",value:function(){return f.getLocal("ARK_LOGINID")}},{key:"removeLoginId",value:function(){f.removeLocal("ARK_LOGINID")}},{key:"setTrackId",value:function(e){e&&f.setLocal("ARK_TRACKID",e)}},{key:"getTrackId",value:function(){return f.getLocal("ARK_TRACKID")}},{key:"removeTrackId",value:function(){f.removeLocal("ARK_TRACKID")}},{key:"getAliasId",value:function(){return f.getLocal("ARK_LOGINID")}},{key:"removeAliasId",value:function(){f.removeLocal("ARK_LOGINID")}},{key:"setIdentifyId",value:function(e){f.setLocal("ARK_TRACKID",e)}},{key:"getIdentifyId",value:function(){return f.getLocal("ARK_TRACKID")}},{key:"removeIdentifyId",value:function(){f.removeLocal("ARK_TRACK_LOGIN")}}]),e}(),R=new b,_={utm_campaign_id:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:"",utm_campaign:""};function L(){_={utm_campaign_id:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:"",utm_campaign:""}}var E=null,$=null,k=null,I=null,D=null,O=null,w=null,P=null,F=null;wx.onNetworkStatusChange(function(e){F=e.networkType});var N=y.base;function x(){return N.appid}function C(){return N.$debug}function U(){return R.getId()}function K(e){return"/"!==N.uploadURL.charAt(N.uploadURL.length-1)&&(N.uploadURL+="/"),N.uploadURL}function M(){return y.base.allowTimeCheck&&y.base.logflag?+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0):+new Date}function j(){return!!(f.getLocal("ANSSERVERTIME")&&y.base.allowTimeCheck&&y.base.logflag)}function V(){return y.status.FnName}function Y(){return!(!R.getAliasId()&&!f.getLocal("ARK_TRACK_LOGIN"))}function q(){return k=y.system.system.screenWidth||""}function G(){return $=y.system.system.screenHeight||""}function J(){return E=y.system.system.system.split(" ")[0]||""}function W(){return I=y.system.system.brand||""}function B(){return D=y.system.system.version||""}function z(){return O=y.system.system.system.split(" ")[1]||""}function H(){return w=y.system.system.model||""}function Z(){return P=y.system.system.language||""}function Q(){return F=y.system.netWork.networkType}function X(){var e=getCurrentPages();return 1<e.length?e[e.length-2].route:ee()}function ee(){return y.system.scene?y.system.scene.scene.toString():""}var te="GMT"+g.clientTimeZone();function ae(){return A.getId()}function re(){var e=f.getLocal("FRISTIME");return f.setLocal("FRISTIME",!1),null==e||e}function ne(){var e=new Date;y.base.allowTimeCheck&&y.base.logflag&&(e=new Date(+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)));var t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var r=e.getDate(),n=t+""+a+(r=r<10?"0"+r:r),s=f.getLocal("FRISTDAY");return(!s||n===s)&&(f.setLocal("FRISTDAY",n),!0)}function se(){var e=g.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");return y.base.allowTimeCheck&&y.base.logflag&&(e=g.format(new Date(+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)),"yyyy-MM-dd hh:mm:ss.SSS")),f.getLocal("ARKFRISTPROFILE")&&(e=f.getLocal("ARKFRISTPROFILE")),e}function oe(){return R.getTrackId()||R.jsId()}function ue(){var e=getCurrentPages();return 0<e.length?"/"+e[e.length-1].route:""}function ie(){return N.$lib_version}var ce=f.getData("UTMSESSION")||"";function le(){return _.utm_campaign_id}function pe(){return _.utm_source}function ye(){return _.utm_medium}function ve(){return _.utm_term}function fe(){return _.utm_content}function ge(){return _.utm_campaign}function me(){return y.base.$share_level}function he(){return y.base.$share_path}function de(){return y.base.$share_id}_.utm_campaign&&_.utm_source&&_.utm_medium?(ce!==JSON.stringify(_)&&A.setId(),f.setData("UTMSESSION",JSON.stringify(_))):(L(),f.removeData("UTMSESSION"));var Se={resetKeywords:["appid","$debug","uploadUrl"],uploadURL:{valueType:0,value:K,check:{value:["isString","nimLength","isUrl"],errorCode:"60007",successCode:"20008"}},appid:{valueType:0,value:x,check:{value:["isString","nimLength"],errorCode:"60006",successCode:"20006"}},auto:{check:{value:["isBoolean"],errorCode:"60003"}},autoProfile:{check:{value:["isBoolean"],errorCode:"60003"}},xwho:{valueType:0,value:U,check:{value:["isString","nimLength"]}},xwhen:{valueType:0,value:M},xwhat:{valueType:0,value:V,check:{value:["isString","nimLength"]}},xcontext:{$lib:{valueType:1,value:"WeChat"},$lib_version:{valueType:0,value:ie,check:{value:["isString"],successCode:"20007"}},$platform:{valueType:1,value:"WeChat"},$debug:{valueType:0,value:C,check:{value:["isNumber","isDebug"]}},$is_login:{valueType:0,value:Y,check:{value:["isBoolean"]}},$screen_width:{valueType:0,value:q,check:{value:["isNumber"]}},$screen_height:{valueType:0,value:G,check:{value:["isNumber"]}},$time_zone:{valueType:1,value:te},$os:{valueType:0,value:J,check:{value:["isString"]}},$browser:{valueType:1,value:"WeChat",check:{value:["isString"]}},$brand:{valueType:0,value:W,check:{value:["isString"]}},$browser_version:{valueType:0,value:B,check:{value:["isString"]}},$os_version:{valueType:0,value:z,check:{value:["isString"]}},$model:{valueType:0,value:H,check:{value:["isString"]}},$language:{valueType:0,value:Z,check:{value:["isString"]}},$network:{valueType:0,value:Q,check:{value:["isString"]}},$session_id:{valueType:0,value:ae},$scene:{valueType:0,value:ee},$referrer:{valueType:0,value:X},$startup_time:{valueType:0,value:se},$is_first_time:{valueType:0,value:re},$is_first_day:{valueType:0,value:ne},$first_visit_time:{valueType:0,value:se},$original_id:{valueType:0,value:oe,check:{value:["isString"]}},$is_time_calibrated:{valueType:0,value:j},$url:{valueType:0,value:ue},$utm_campaign_id:{valueType:0,value:le},$utm_source:{valueType:0,value:pe},$utm_medium:{valueType:0,value:ye},$utm_term:{valueType:0,value:ve},$utm_content:{valueType:0,value:fe},$utm_campaign:{valueType:0,value:ge},$share_id:{valueType:0,value:de},$share_level:{valueType:0,value:me},$share_path:{valueType:0,value:he}},xcontextCommonRule:{check:{key:["isString","length99","notSpecialCharacters","keywords"],value:["notObject","isArrayString","length255"]}},$track:{check:{key:["isString","notSpecialCharacters","length99"]}},$alias:{check:{key:["isString","keyLength255"]}},$profile_increment:{check:{key:["isString","length99","notSpecialCharacters"],value:["isNumber"]}},$profile_unset:{check:{key:["isString","length99","notSpecialCharacters"]}},$pageview:{check:{key:["isString","keyLength255"]}}};function Te(e,t){for(var a=0;a<t.length;a++){if(!d[t[a]](e))return!1}return!0}function Ae(e,t,a){var r=a.check,n=!0,s=!0;if(!r)return n;var o=r.key,u=r.value;if(o&&(n=Te(e,o),y.status.key=e,n||(y.status.code=400,m())),u){if(y.status.code=200,t&&"Array"==g.paramType(t)){for(var i=0;i<t.length;i++)s=Te(t[i],["isString","length255"]),y.status.key=t[i],s||(y.status.code=400,m());return}s=Te(t,u),"Array"!==g.paramType(t)&&(y.status.value=t),s||(y.status.code=400,m())}return n}function be(e,t){var a=t||Se,r={};for(var n in e){var s=e[n],o=a[n];if(o){var u="";if("Object"===g.paramType(s)){var i=be(s,o);r[n]=i}else g.objHasKay(o,"valueType")&&(0===o.valueType&&(u=o.value(),"String"==g.paramType(u)&&500<u.length?r[n]=g.stringSlice(u,499)+"$":r[n]=u),1===o.valueType&&(u=o.value,"String"==g.paramType(u)&&500<u.length?r[n]=g.stringSlice(u,499)+"$":r[n]=u))}}return r}function Re(){y.status={code:200,FnName:y.status.FnName,key:"",value:"",errorCode:"",successCode:""}}function _e(e){if(!(e=e||!1)){var t=y.base;for(var a in t){if("Object"!==g.paramType(t[a]))if("$debug"===a||"appid"===a||"uploadURL"===a)Storage.getLocal("ANS"+a.toUpperCase())!==t[a]&&(e=!0),e&&Storage.setLocal("ANS"+a.toUpperCase(),t[a])}}if(e){if(f.removeLocal("ARKSUPER"),f.removeData("STARTUP"),f.setLocal("FRISTDAY",g.format(new Date,"yyyyMMdd")),y.base.allowTimeCheck&&y.base.logflag){var r=g.format(new Date(+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)),"yyyyMMdd");f.setLocal("FRISTDAY",r)}f.setLocal("FRISTIME",!0),f.removeLocal("POSTDATA"),f.removeLocal("ANSSERVERTIME"),f.removeLocal("ARKFRISTPROFILE"),f.removeLocal("ARKFRISTPROFILESEND")}return e}function Le(e,t,a,r){Re();var n=Se[t]||Se.xcontextCommonRule;if("Object"!==g.paramType(e)||1==a){var s=Te(e,n.check.key);return y.status.key=e,!(!s&&(m(),"aliasId"==r||"distinctId"==r))}for(var o in 0==Object.keys(e).length&&(y.status.errorCode=600021,y.status.value=0,m()),e){(s=Ae(o,e[o],n))||"600019"===y.status.errorCode&&500<e[o].length&&(e[o]=g.stringSlice(e[o],499)+"$")}return!0}for(var Ee=[],$e=e||{},ke=0;ke<Ee.length;ke++)$e=g.objMerge(e,Ee[ke]);var Ie={},De={},Oe=$e.base,we=Oe.outer;for(ke=0;ke<we.length;ke++)Oe[we[ke]]?De[we[ke]]=g.toObj(Oe[we[ke]]):De[we[ke]]="";for(var Pe in $e)"base"!=Pe&&(Ie[Pe]=g.objMerge(De,g.toDeepObj($e[Pe])));function Fe(e){return Ie[e]||Ie.commonTemp}Ie.commonTemp=De;var Ne=!0;function xe(e){if("Object"!==g.paramType(e)||g.isEmptyObject(e))return!1;for(var t=!0,a=0;a<y.baseJson.length;a++){var r=y.baseJson[a];"xwhat"!==r&&(!e[r]||"Object"==g.paramType(e[r])&&g.isEmptyObject(e[r]))&&(t=!1)}return t}function Ce(e){var t=f.getLocal("POSTDATA")||[],a=[];if(0<t.length)for(var r=0;r<t.length;r++)"Array"===g.paramType(t[r])?a.push.apply(a,t[r]):"Object"===g.paramType(t[r])&&xe(t[r])&&a.push(t[r]);t.length<=500&&0<Object.keys(e).length&&a.push(e),f.setLocal("POSTDATA",a),!0===Ne&&Ue(a)}function Ue(e){f.removeLocal("POSTDATA"),Re(),Ne=!1;var n=e,t={url:y.base.uploadURL+"?appid="+y.base.appid,data:e,encryptType:y.base.encryptType};wx.AnalysysAgent.encrypt&&"Function"==g.paramType(wx.AnalysysAgent.encrypt.uploadData)&&(t=wx.AnalysysAgent.encrypt.uploadData(t)),y.status.key=t.url,y.status.value=JSON.stringify(e),y.status.successCode="20012",p(),wx.request({url:t.url,method:"POST",data:JSON.stringify(t.data),dataType:"json",success:function(e){if(Ne=!0,"String"==g.paramType(e.data)&&(wx.AnalysysAgent.encrypt&&"Function"==g.paramType(wx.AnalysysAgent.encrypt.decodeRes)?e.data=JSON.parse(wx.AnalysysAgent.encrypt.decodeRes(e.data)):"H4sIAAAAAAAAAKtWSs5PSVWyMjIwqAUAVAOW6gwAAAA="==e.data?e.data={code:200}:"H4sIAAAAAAAAAKtWSs5PSVWyMjUwqAUA7TtBdwwAAAA="==e.data?e.data={code:500}:"H4sIAAAAAAAAAKtWSs5PSVWyMjEy0FHKLU5XslJySSxJVHBJTS6qLChRcC0qyi/S01OqBQBdATGSKQAAAA=="==e.data?e.data={code:420}:e.data={code:200}),200==e.data.code||500==e.data.code||420==e.data.code){var t=f.getLocal("POSTDATA")||[];0<t.length&&Ue(t),200==e.data.code?(y.status.successCode="20001",p()):(y.status.errorCode="60008",m())}else{y.status.errorCode="60008",m();var a=f.getLocal("POSTDATA")||[],r=[].concat(v(n),v(a));f.setLocal("POSTDATA",r),0<a.length&&Ue(r)}},fail:function(){Ne=!0,y.status.errorCode="60008",m();var e=f.getLocal("POSTDATA")||[],t=[].concat(v(n),v(e));f.setLocal("POSTDATA",t),0<e.length&&Ue(t)}})}function Ke(e,t){y.status.FnName="$profile_set_once",Re();var a=g.toObj(e,t);Le(a);var r=be(Fe("$profile_set_once"));(r=g.delEmpty(r)).xcontext=g.objMerge(r.xcontext,a),Ce(r)}function Me(e,t){y.status.FnName="$pageview",Re();0<arguments&&Le(e,"$pageview",!0),1<arguments.length&&Le(t);var a=be(Fe("$pageview"));a=g.delEmpty(a);var r=f.getLocal("ARKSUPER")||{};0<Object.keys(r).length&&(a.xcontext=g.objMerge(a.xcontext,r));var n=y.base.appProperty;"Object"==g.paramType(n)&&n&&(a.xcontext=g.objMerge(a.xcontext,n)),a.xcontext=g.objMerge(a.xcontext,t||{}),e&&"String"==g.paramType(e)&&(a.xcontext=g.objMerge(a.xcontext,{$pagename:e})),Ce(a)}function je(e){var t=g.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");y.base.allowTimeCheck&&y.base.logflag&&(t=g.format(new Date(+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)),"yyyy-MM-dd hh:mm:ss.SSS"));var a={$first_visit_time:f.getLocal("ARKFRISTPROFILE")||t,$first_visit_language:Z()},r=y.base.autoProfile,n=y.base.auto;if("startUp"==e||"appStart"==e){if(!0===r)if(0==(f.getLocal("ARKFRISTPROFILESEND")||!1)){f.setLocal("ARKFRISTPROFILESEND",!0),y.status.FnName="$profile_set_once",Re();var s=be(Fe("$profile_set_once"));(s=g.delEmpty(s)).xcontext=g.objMerge(s.xcontext,a);var o=f.getLocal("POSTDATA");o=[].concat(v(o),v(g.objInArray(s))),f.setLocal("POSTDATA",o)}!0===n&&"startUp"==e?Me():Ce({})}else{if("alias"!=e)return;f.setLocal("ARKFRISTPROFILESEND",!0),Ke(a)}}function Ve(e){var t=y.system.scene=e;t.query&&0<Object.keys(t.query).length&&(t.query.utm_campaign&&t.query.utm_medium&&t.query.utm_source&&(_.utm_campaign_id=t.query.campaign_id,_.utm_campaign=t.query.utm_campaign,_.utm_content=t.query.utm_content,_.utm_medium=t.query.utm_medium,_.utm_source=t.query.utm_source,_.utm_term=t.query.utm_term),t.query.share_id&&t.query.share_level&&t.query.share_path&&(y.base.$share_id=t.query.share_id,y.base.$share_level=t.query.share_level,y.base.$share_path=decodeURIComponent(t.query.share_path))),e.scene&&(y.system.scene.scene=e.scene),y.isStartUp=!0,y.status.FnName="$startup",Re();var a=f.getLocal("ARKAPPID"),r=f.getLocal("ARKDEBUG"),n=f.getLocal("ARKUPLOADURL");if((a!==y.base.appid||1===r&&r!==y.base.$debug||n!==y.base.uploadURL)&&(g.delFristDay(),g.delFristTime(),null!=a&&(R.removeTrackId(),f.removeLocal("ARKSUPER"),f.removeLocal("ARKFRISTPROFILE"),f.removeLocal("ARKFRISTPROFILESEND")),R.removeLoginId(),f.setData("STARTUP",!0),f.removeData("STARTUPTIME"),y.base.allowTimeCheck||f.removeLocal("ANSSERVERTIME"),f.removeLocal("POSTDATA"),g.setFristDay(),g.setFristTime()),f.setLocal("ARKAPPID",y.base.appid),f.setLocal("ARKDEBUG",y.base.$debug),f.setLocal("ARKUPLOADURL",y.base.uploadURL),!1!==f.getData("STARTUP")){A.setId(),f.setData("STARTUP",!1);var s=be(Fe("$startup"));s=g.delEmpty(s),f.getLocal("ARKFRISTPROFILE")||f.setLocal("ARKFRISTPROFILE",g.format(new Date(s.xwhen),"yyyy-MM-dd hh:mm:ss.SSS"));for(var o=y.FnSuperCatch,u=0;u<o.length;u++)o[u][0].apply(o[u][0],o[u][1]);y.FnSuperCatch=[];var i=f.getLocal("ARKSUPER")||{};s.xcontext=g.objMerge(s.xcontext,i);var c=y.base.appProperty||{};if(s.xcontext=g.objMerge(s.xcontext,c),f.setData("STARTUPTIME",g.format(new Date(s.xwhen),"yyyy-MM-dd hh:mm:ss.SSS")),1==y.base.autoProfile){var l=f.getLocal("POSTDATA")||[];l=[].concat(v(l),v(g.objInArray(s))),f.setLocal("POSTDATA",l),je("appStart");var p=y.FnCatch;for(u=0;u<p.length;u++)p[u][0].apply(p[u][0],p[u][1]);y.FnCatch=[]}else Ce(g.delEmpty(s))}}function Ye(){y.isStartUp=!0,y.status.FnName="$startup",Re();var e=f.getLocal("ARKAPPID"),t=f.getLocal("ARKDEBUG"),a=f.getLocal("ARKUPLOADURL");if((e!==y.base.appid||1===t&&t!==y.base.$debug||a!==y.base.uploadURL)&&(g.delFristDay(),g.delFristTime(),null!=e&&(R.removeTrackId(),f.removeLocal("ARKFRISTPROFILE"),f.removeLocal("ARKFRISTPROFILESEND"),R.removeLoginId()),f.removeLocal("ARKSUPER"),f.setData("STARTUP",!0),f.removeData("STARTUPTIME"),y.base.allowTimeCheck||f.removeLocal("ANSSERVERTIME"),f.removeLocal("POSTDATA"),g.setFristDay(),g.setFristTime()),f.setLocal("ARKDEBUG",y.base.$debug),f.setLocal("ARKAPPID",y.base.appid),f.setLocal("ARKUPLOADURL",y.base.uploadURL),!1!==f.getData("STARTUP")){A.setId(),f.setData("STARTUP",!1);var r=be(Fe("$startup"));r=g.delEmpty(r),f.getLocal("ARKFRISTPROFILE")||f.setLocal("ARKFRISTPROFILE",g.format(new Date(r.xwhen),"yyyy-MM-dd hh:mm:ss.SSS"));for(var n=y.FnSuperCatch,s=0;s<n.length;s++)n[s][0].apply(n[s][0],n[s][1]);y.FnSuperCatch=[];var o=f.getLocal("ARKSUPER")||{};r.xcontext=g.objMerge(r.xcontext,o);var u=y.base.appProperty||{};if(r.xcontext=g.objMerge(r.xcontext,u),f.setData("STARTUPTIME",g.format(new Date(r.xwhen),"yyyy-MM-dd hh:mm:ss.SSS")),1!=y.base.autoProfile&&1!=y.base.auto)Ce(g.delEmpty(r));else{var i=f.getLocal("POSTDATA")||[];i=[].concat(v(i),v(g.objInArray(r))),f.setLocal("POSTDATA",i),je("startUp")}var c=y.FnCatch;for(s=0;s<c.length;s++)c[s][0].apply(c[s][0],c[s][1]);y.FnCatch=[]}else 1==y.base.auto&&Me()}function qe(e,t){y.status.FnName="$registerSuperProperty",Re();var a=g.toObj(e,t);Le(a);var r=f.getLocal("ARKSUPER")||{},n=g.objMerge(r,a);f.setLocal("ARKSUPER",n),y.status.successCode="20002",y.status.value=JSON.stringify(a),p()}function Ge(e){y.status.FnName="$unregisterSuperProperty",Re();Le(e);var t=f.getLocal("ARKSUPER")||{};if(!t.hasOwnProperty(e))return y.status.successCode="20011",y.status.value=e,void p();delete t[e],f.setLocal("ARKSUPER",t),y.status.successCode="20003",y.status.value=e,p()}function Je(e,t){y.status.FnName="$registerSuperProperties",Re();var a=g.toObj(e,t);Le(a);var r=f.getLocal("ARKSUPER")||{},n=g.objMerge(r,a);f.setLocal("ARKSUPER",n),y.status.successCode="20002",y.status.value=JSON.stringify(a),p()}function We(e){y.status.FnName="$getSuperProperty",Re();Le(e,"$getSuperProperty",!0);var t=f.getLocal("ARKSUPER")||{},a=t[e];return t.hasOwnProperty(e)?(y.status.successCode="20010",y.status.value=a,y.status.key=e,p(),a):(y.status.successCode="20009",y.status.key=e,p(),"")}function Be(){y.status.FnName="$getSuperProperties",Re();var e=f.getLocal("ARKSUPER")||{};return y.status.successCode="20010",y.status.value=JSON.stringify(e),p(),e}function ze(){y.status.FnName="$clearSuperProperties",Re(),f.setLocal("ARKSUPER",{}),y.status.successCode="20004",p()}function He(e){y.status.FnName="$alias",Re();if(Le(e,"$alias",!0,"aliasId")){f.setLocal("ARK_LOGINID",e);var t=be(Fe("$alias"));t=g.delEmpty(t),1!=y.base.autoProfile?Ce(t):(f.setLocal("POSTDATA",g.objInArray(t)),je("alias"))}}function Ze(e,t){y.status.FnName=e,Re(),Le(e,"$track",!0),1<arguments.length&&Le(t);var a=be(Fe("$track")),r=f.getLocal("ARKSUPER")||{};a.xcontext=g.delEmpty(a.xcontext),0<Object.keys(r).length?(r=g.objMerge(r,t),a.xcontext=g.objMerge(a.xcontext,r)):a.xcontext=g.objMerge(a.xcontext,t),Ce(a)}function Qe(e,t){y.status.FnName="$identify",Re(),Le(e,"$alias",!0,"distinctId")&&(!0===t&&f.setLocal("ARK_TRACK_LOGIN",!0),f.setLocal("ARK_TRACKID",e),y.status.successCode="20002",y.status.value=e,p())}function Xe(){var e=g.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");y.base.allowTimeCheck&&y.base.logflag&&(e=+new Date+(f.getLocal("ANSSERVERTIME")?Number(f.getLocal("ANSSERVERTIME")):0)),e=g.format(new Date(e),"yyyy-MM-dd hh:mm:ss.SSS"),Re(),R.removeARKId(),R.removeTrackId(),R.removeLoginId(),R.removeIdentifyId(),ze(),_e(!0),A.setId(),!0===y.base.autoProfile&&Ke({$reset_time:e});y.status.FnName="$reset",y.status.successCode="20005",p()}function et(e,t){y.status.FnName="$profile_set",Re();var a=g.toObj(e,t);Le(a);var r=be(Fe("$profile_set"));(r=g.delEmpty(r)).xcontext=g.objMerge(r.xcontext,a),Ce(r)}function tt(e,t){y.status.FnName="$profile_increment",Re();var a=g.toObj(e,t);Le(a,"$profile_increment");var r=be(Fe("$profile_increment"));(r=g.delEmpty(r)).xcontext=g.objMerge(r.xcontext,a),Ce(r)}function at(e,t){y.status.FnName="$profile_append",Re();var a=g.toObj(e,t);Le(a);var r=be(Fe("$profile_append"));(r=g.delEmpty(r)).xcontext=g.objMerge(r.xcontext,a),Ce(r)}function rt(e){y.status.FnName="$profile_unset",Re();var t=g.toObj(e,"");Le(t,"$profile_unset");var a=be(Fe("$profile_unset"));(a=g.delEmpty(a)).xcontext=g.objMerge(a.xcontext,t),Ce(a)}function nt(){y.status.FnName="$profile_delete",Re();var e=be(Fe("$profile_delete"));Ce(e=g.delEmpty(e))}function st(e){var t=R.getId();if(y.base.autoShare){var a=getCurrentPages(),r=a[a.length-1].__route__;Ze("$share",{$share_id:t,$share_level:Number(y.base.$share_level)+1,$share_path:r});var n="share_id="+t+"&share_level="+(Number(y.base.$share_level)+1)+"&share_path="+encodeURIComponent(r);return e.path?-1<e.path.indexOf("?")?e.path=e.path+"&"+n:e.path=e.path+"?"+n:e.path="/"+r+"?"+n,e}}function ot(e){if(Re(),y.status.FnName="$appProperty","Object"!=g.paramType(e)||!e)return y.status.errorCode="600016",y.status.value=JSON.stringify(e),void m();if(Le(e),y.base.appProperty)for(var t in e)y.base.appProperty[t]=e[t];else y.base.appProperty=e;y.status.successCode="20002",y.status.value=JSON.stringify(e),p()}function ut(){return R.getTrackId()||R.jsId()}function it(){y.status.FnName="getPresetProperties",Re();var e=be(Fe("$getPresetProperties"));return delete(e=g.delEmpty(e)).xcontext.$is_login,y.status.successCode="20010",y.status.value=JSON.stringify(e.xcontext),p(),e.xcontext}function ct(){return new Promise(function(t,a){wx.getSystemInfo({success:function(e){t(e)},fail:function(e){a(e)}})}).catch(function(e){})}function lt(){return new Promise(function(t,a){wx.getNetworkType({success:function(e){t(e)},fail:function(e){a(e)}})}).catch(function(e){})}var pt=function(){return new Promise(function(n,e){if(Re(),!y.base.allowTimeCheck)return n();var t=y.base.uploadURL;t=t.split("up")[0],wx.request({url:t+"configure",method:"GET",success:function(e){if(n(e),e.header&&e.header.Date){var t=+new Date,a=e.header.Date,r=y.base.maxDiffTimeInterval;r<0&&(r=30),a&&r<Math.abs((new Date(a)-t)/1e3)&&(y.base.logflag||(f.setLocal("ANSSERVERTIME",new Date(a)-t),y.status.successCode="20013",y.status.value=g.format(new Date(a),"yyyy-MM-dd hh:mm:ss +SSS"),y.status.key=g.format(new Date(t),"yyyy-MM-dd hh:mm:ss +SSS"),y.status.FnName=(new Date(a)-t)/1e3+"s",p(),y.base.logflag=!0))}},fail:function(e){n(e)}})}).catch(function(e){})},yt=!0,vt=[];function ft(a,r,n){return function(){var t=arguments;1!=yt||null!=y.system.system&&null!=y.system.netWork?!r&&1!=y.isStartUp||1!=yt?1==n?y.FnSuperCatch.push([a,arguments]):1==yt&&!1===n?vt.push([a,arguments]):y.FnCatch.push([a,arguments]):a.apply(a,arguments):Promise.all([ct(),lt(),pt()]).then(function(e){yt=!0,y.system.system=e[0],y.system.netWork=e[1],0<vt.length&&(vt[0][0](vt[0][1]),vt=[]),r||1==y.isStartUp?a.apply(a,t):n?y.FnSuperCatch.push([a,t]):y.FnCatch.push([a,t])})}}var gt=function e(){a(this,e),this.appStart=ft(Ve,!0,!1),this.startUp=ft(Ye,!0),this.pageView=ft(Me,!1),this.registerSuperProperty=ft(qe,!1,!0),this.unRegisterSuperProperty=ft(Ge,!1,!0),this.registerSuperProperties=ft(Je,!1,!0),this.getSuperProperty=We,this.getSuperProperties=Be,this.clearSuperProperties=ft(ze,!1,!0),this.alias=ft(He,!0),this.track=ft(Ze,!1),this.identify=Qe,this.reset=Xe,this.profileSet=ft(et,!1),this.profileSetOnce=ft(Ke,!1),this.profileIncrement=ft(tt,!1),this.profileAppend=ft(at,!1),this.profileUnset=ft(rt,!1),this.profileDelete=ft(nt,!1),this.share=st,this.appProperty=ot,this.getDistinctId=ut,this.getPresetProperties=it};y.isStartUp=!0,y.base.auto=!1;var mt=function(){function e(){return a(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return r(e,gt),t(e,[{key:"appkey",set:function(e){Re(),y.status.FnName="appkey",y.status.successCode="20002",y.status.value=e,p(),y.status.successCode="20007",y.status.value=y.base.$lib_version,p(),y.base.appid=e},get:function(){return y.base.appid}},{key:"debugMode",set:function(e){Re(),y.base.$debug=e},get:function(){return y.base.$debug}},{key:"uploadURL",set:function(e){return Re(),e?g.checkURL(e)?("/"!==e.charAt(e.length-1)&&(e+="/"),y.base.uploadURL=e+"up",y.status.successCode="20008",y.status.value=e,void p()):(y.status.errorCode="600011",y.status.key="uploadURL",y.status.value=e,void m()):(y.status.errorCode="60007",void m())},get:function(){return y.base.uploadURL}},{key:"autoProfile",set:function(e){if(Re(),"Boolean"!==g.paramType(e))return y.status.key="autoProfile",y.status.errorCode="60003",y.status.value=e,void m();y.base.autoProfile=e},get:function(){return y.base.autoProfile}},{key:"encryptType",set:function(e){if(Re(),"Number"!==g.paramType(e))return y.status.key="encryptType",y.status.errorCode="60002",y.status.value=e,void m();y.base.encryptType=e},get:function(){return y.base.encryptType}},{key:"autoShare",set:function(e){if(Re(),"Boolean"!==g.paramType(e))return y.status.key="autoShare",y.status.errorCode="60003",y.status.value=e,void m();y.base.autoShare=e},get:function(){return y.base.autoShare}},{key:"allowTimeCheck",set:function(e){if(Re(),"Boolean"!==g.paramType(e))return y.status.key="allowTimeCheck",y.status.errorCode="60003",y.status.value=e,void m();y.base.allowTimeCheck=e},get:function(){return y.base.maxDiffTimeInterval}},{key:"maxDiffTimeInterval",set:function(e){if(Re(),"Number"!==g.paramType(e))return y.status.key="maxDiffTimeInterval",y.status.errorCode="60002",y.status.value=e,void m();y.base.maxDiffTimeInterval=e}}]),e}(),ht=new mt;delete ht.startUp,wx.AnalysysAgent=ht,module.exports=ht;
